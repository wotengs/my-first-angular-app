<div
  class="card product-card position-relative"
  appHighlightCartedProduct
  [isCarted]="!!product()?.carted"
>
  <div class="position-absolute top-0 end-0 p-2">
    <div class="btn-group">
      <button class="btn btn-sm btn-light menu-toggle rounded-3" (click)="openMenu($event)">
        ⋯
      </button>
      @if (showMenu) {
      <div class="dropdown-menu show p-2">
        <button class="dropdown-item rounded-3" (click)="doEdit()">Update</button>
        <button class="dropdown-item text-danger rounded-3 btn-warning" (click)="doDelete()">
          Delete
        </button>
      </div>
      }
    </div>
  </div>

  <img
    class="card-img-top thumb"
    src="{{ thumbnailUrl() }}"
    alt="{{ product()?.title || 'product' }}"
  />

  <div class="card-body">
    <h5 class="card-title">{{ product()?.title }}</h5>
    <p class="card-text description-truncated">{{ product()?.description }}</p>
    <p class="card-text">
      <small class="text-muted">{{ product()?.category }}</small>
    </p>

    <div class="meta mt-2">
      <div class="price">{{ priceLabel() }}</div>
      <div class="rating">★ {{ product()?.rating ?? '-' }}</div>
      <div class="stock" [class.low]="(product()?.stock ?? 0) &lt; 5">
        {{ product()?.stock ?? 'N/A' }} in stock
      </div>
    </div>

    <div class="d-flex justify-content-between align-items-center">
      <div class="brand">{{ product()?.brand }}</div>
      <button
        class="btn btn-outline-primary btn-sm rounded-3"
        id="product-{{ product()?.id }}"
        (click)="productClicked()"
        [attr.aria-pressed]="product()?.carted"
      >
        @if (product()?.carted) {
        <i class="bi bi-cart-x" aria-hidden="true"></i>
        <span class="label">Remove</span>
        } @else {
        <i class="bi bi-cart-plus" aria-hidden="true"></i>
        <span class="label">Add</span>
        }
      </button>
    </div>
  </div>
</div>
